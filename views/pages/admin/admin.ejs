<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/Article">
  <%= include ../../partials/head.ejs %>
  <body class="<%= season %>-page">
    <%= include ../../partials/nav.ejs %>

    <section class="admin-full-page">
      <form class="logout" action="/logout"
            method="post" enctype="application/x-www-form-urlencoded">
        <button type="submit">
          <i class="fa fa-user-times"></i> Logout
        </button>
      </form>
      <div class="logo">
        <img src="assets/logo.png">
      </div>
      <article>
        <h1>Welcome to Your Admin Dashboard</h1>
        <h4>From here you can edit all your events and corresponding details</h4>
      </article>
      <article>
        <h3>Choose an Event to Edit</h3>
        <h4>Then click the pencil</h4>
        <form action="/admin" method="post" enctype="application/x-www-form-urlencoded">
          <select name="eventChoice">
            <option value="<%= JSON.stringify(data.winter.sidehillerSnowshoe) %>">
              <%= data.winter.sidehillerSnowshoe.title %></option>
            <option value="<%= JSON.stringify(data.winter.kingmanFarm) %>">
              <%= data.winter.kingmanFarm.title %></option>
            <option value="<%= JSON.stringify(data.winter.snowshoeHullabaloo) %>">
              <%= data.winter.snowshoeHullabaloo.title %></option>
            <option value="<%= JSON.stringify(data.winter.snowshoeChampionship) %>">
              <%= data.winter.snowshoeChampionship.title %></option>
            <option value="<%= JSON.stringify(data.spring.ralphWaldo) %>">
              <%= data.spring.ralphWaldo.title %></option>
            <option value="<%= JSON.stringify(data.spring.exeterTrail) %>">
              <%= data.spring.exeterTrail.title %></option>
            <option value="<%= JSON.stringify(data.summer.loonMountainRace) %>">
              <%= data.summer.loonMountainRace.title %></option>
            <option value="<%= JSON.stringify(data.summer.kingmanFarmTrailRace) %>">
              <%= data.summer.kingmanFarmTrailRace.title %></option>
            <option value="<%= JSON.stringify(data.summer.harmonyHill) %>">
              <%= data.summer.harmonyHill.title %></option>
            <option value="<%= JSON.stringify(data.fall.brettonWoods) %>">
              <%= data.fall.brettonWoods.title %></option>
            <option value="<%= JSON.stringify(data.fall.vulcansFury) %>">
              <%= data.fall.vulcansFury.title %></option>
            <option value="<%= JSON.stringify(data.fall.roaringFalls) %>">
              <%= data.fall.roaringFalls.title %></option>
          </select>
          <button class="submit-btn" type="submit"><i class="fa fa-pencil"></i></button>
        </form>
      </article>
      <hr>
      <% if(event) { %>
        <form class="edit-form" action="/update-event"
              method="post" enctype="application/x-www-form-urlencoded">
          <div>
            <label>Title</label>
            <input type="text" name="title" value="<%= event.title %>">
          </div>
          <div>
            <label>Date</label>
            <input type="text" name="date" value="<%= event.date %>">
          </div>
          <div>
            <label>Address</label>
            <input type="text" name="address" value="<%= event.address %>">
            <p>ie. Old Church (leave blank if not needed)</p>
          </div>
          <div>
            <label>Address Line 2</label>
            <input type="text" name="address2" value="<%= event.address2 %>">
            <p>ie. 125 Main Street</p>
          </div>
          <div>
            <label>City</label>
            <input type="text" name="city" value="<%= event.city %>">
          </div>
          <div>
            <label>State</label>
            <input type="text" name="state" value="<%= event.state %>">
          </div>
          <div>
            <label>Distance</label>
            <input type="text" name="distance" value="<%= event.distance %>">
          </div>
          <div>
            <label>Start Time</label>
            <input type="text" name="starttime" value="<%= event.starttime %>">
          </div>
          <div>
            <label>Bib Pickup Time</label>
            <input type="text" name="bibtime" value="<%= event.bibtime %>">
          </div>
          <div>
            <label>Cost</label>
            <input type="text" name="cost" value="<%= event.cost %>">
          </div>
          <div>
            <label>Race Director Name(s)</label>
            <input type="text" name="directorname" value="<%= event.directorname %>">
          </div>
          <div>
            <label>Race Director Email(s)</label>
            <input type="text" name="directoremail" value="<%= event.directoremail %>">
          </div>
          <div>
            <label>Race Designer</label>
            <input type="text" name="designer" value="<%= event.designer %>">
          </div>
          <div>
            <label>Registration Status</label>
            <input type="text" name="registrationStatus" value="<%= event.registrationStatus %>">
            <p>Type <strong>open</strong> or <strong>closed</strong></p>
          </div>
          <div>
            <label>Registration Link</label>
            <input type="text" name="registrationLink" value="<%= event.registrationLink %>">
            <p>Paste the Registration URL</p>
          </div>
          <div>
            <label>Results Link</label>
            <input type="text" name="resultsUrl" value="<%= event.resultsUrl %>">
            <p>Paste the Results Page URL</p>
          </div>
          <div>
            <label>Photo Gallery Link</label>
            <input type="text" name="galleryUrl" value="<%= event.galleryUrl %>">
            <p>Paste the Photo Gallery URL</p>
          </div>
          <div>
            <label>Photographer</label>
            <input type="text" name="photographer" value="<%= event.photographer %>">
            <p>Enter photographer name</p>
          </div>

          <input type="text" class="hidden" name="season"
                 value="<%= event.season %>">
          <input type="text" class="hidden" name="key"
                 value="<%= event.key %>">
          <p>Changes will not be saved until you click the save button</p>
          <p>NOTE: Changes will be live instantly and there is no undo. Please
            double check all values are correct before saving</p>
          <button type="submit">SAVE</button>
        </form>

        
          <h3>Event Details</h3>
          <hr>
          <% for(var i=0; i<event.details.length; i++) {
            if (!event.details[i]) {continue;}%>
            <article class="detail-forms-wrapper">
              <form class="remove-blurb-form" action="/remove-detail"
                method="post" enctype="application/x-www-form-urlencoded">
                <input type="text" class="hidden" name="season"
                       value="<%= event.season %>">
                <input type="text" class="hidden" name="eventKey"
                       value="<%= event.key %>">
                <input type="text" class="hidden" name="key"
                       value="<%= i %>">
                <button type="submit"><i class="fa fa-times-circle"></i><span>DELETE</span></button>
              </form>
              <form class="details-form" action="/update-details"
                method="post" enctype="application/x-www-form-urlencoded">
                <button type="submit"><i class="fa fa-check-circle"></i><span>SAVE</span></button>
                <div>
                  <label>Title</label>
                  <input type="text" name="title" value="<%= event.details[i].title %>">
                </div>
                <div>
                  <label>Copy</label>
                  <textarea name="copy"><%= event.details[i].copy %></textarea> 
                </div>
                <div>
                  <label>Image URL</label>
                  <input type="text" name="image" value="<%= event.details[i].image %>">
                </div>

                <input type="text" class="hidden" name="season"
                       value="<%= event.season %>">
                <input type="text" class="hidden" name="eventKey"
                       value="<%= event.key %>">
                <input type="text" class="hidden" name="key"
                       value="<%= i %>">
              </form>
            </article>
          <% } %>
      <% } %>
    </section>

    <%= include ../../partials/footer.ejs %>
    <%= include ../../partials/scripts.ejs %>
  </body>
</html>